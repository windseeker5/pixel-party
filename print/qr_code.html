<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code QR - Fête de Valérie</title>
    <style>
        @page {
            margin: 2cm;
            size: A4;
        }

        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 60px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 600px;
            width: 100%;
        }

        .title {
            font-size: 3rem;
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.5rem;
            color: #718096;
            margin-bottom: 60px;
        }

        .step {
            background: #f0f4f8;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 6px solid #667eea;
        }

        .step-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .instruction {
            font-size: 2rem;
            color: #2d3748;
            margin: 30px 0;
            font-weight: 600;
        }

        .qr-container {
            background: #f7fafc;
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            border: 3px solid #e2e8f0;
        }

        .qr-code {
            width: 300px;
            height: 300px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .qr-placeholder {
            width: 100%;
            height: 100%;
            background: #e2e8f0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #718096;
            border: 2px dashed #cbd5e0;
        }

        .note {
            font-size: 1.2rem;
            color: #718096;
            margin-top: 30px;
            font-style: italic;
        }

        .url-info {
            background: #edf2f7;
            padding: 15px;
            border-radius: 10px;
            margin-top: 30px;
            font-family: monospace;
            font-size: 1rem;
            color: #4a5568;
        }

        @media print {
            body {
                background: white !important;
            }
            .container {
                box-shadow: none !important;
                border: 2px solid #e2e8f0;
            }
        }
    </style>
    <!-- QR Code Library -->
    <script src="https://unpkg.com/qrcode-generator@1.4.4/qrcode.js"></script>
</head>
<body>
    <div class="container">
        <h1 class="title">Fête de Valérie</h1>
        <h2 class="subtitle">50e anniversaire</h2>

        <div class="step">
            <div class="step-number">Étape 2</div>
            <p class="instruction">Partagez un moment</p>
        </div>

        <div class="qr-container">
            <div class="qr-code">
                <div id="qr-display" class="qr-placeholder">
                    Code QR sera généré ici
                </div>
            </div>
        </div>

        <p class="note">Scannez avec l'appareil photo de votre téléphone</p>
        <p class="note">Partagez vos photos, vœux et musique</p>

        <div class="url-info">
            <div>URL: <span id="mobile-url">http://192.168.4.1:5000/mobile</span></div>
        </div>

        <div style="margin-top: 60px; padding-top: 30px; border-top: 2px solid #e2e8f0;">
            <p style="font-size: 1.1rem; color: #4a5568;">
                Assurez-vous d'être connecté au WiFi<br>
                <strong>ValerieParty</strong> avant de scanner
            </p>
        </div>
    </div>

    <script>
        // Generate QR code when page loads
        document.addEventListener('DOMContentLoaded', function() {
            generateQRCode();
        });

        function generateQRCode() {
            try {
                // Use default mobile URL - this can be updated when printed
                const url = 'http://192.168.4.1:5000/mobile';

                const qr = qrcode(4, 'L');
                qr.addData(url);
                qr.make();

                // Replace placeholder with actual QR code
                const qrElement = document.getElementById('qr-display');
                if (qrElement) {
                    qrElement.innerHTML = qr.createImgTag(8); // Large size for printing
                    qrElement.style.background = 'white';
                    qrElement.style.border = 'none';
                }

                // Update URL display
                const urlElement = document.getElementById('mobile-url');
                if (urlElement) {
                    urlElement.textContent = url;
                }
            } catch (error) {
                console.error('Error generating QR code:', error);
                document.getElementById('qr-display').innerHTML =
                    'Erreur: Impossible de générer le code QR<br>Veuillez actualiser la page';
            }
        }

        // For dynamic IP generation (if needed)
        function updateQRWithNetworkInfo() {
            fetch('/api/network_info')
                .then(response => response.json())
                .then(data => {
                    const qr = qrcode(4, 'L');
                    qr.addData(data.mobile_url);
                    qr.make();

                    document.getElementById('qr-display').innerHTML = qr.createImgTag(8);
                    document.getElementById('mobile-url').textContent = data.mobile_url;
                })
                .catch(error => {
                    console.log('Using default URL - network info not available');
                });
        }
    </script>
</body>
</html>